<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Não Feche Essa Aba</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Special+Elite&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <p id="mensagem"></p>
    <button id="exitBtn" onclick="irParaFim()" style="display:none;">Sair</button>
    <audio id="glitchSound" src="glitch.mp3.mp3" preload="auto"></audio>
  </div>

  <script>
    let index = 0;
    let playerName = "";
    let frases = [];

    function typeWriter(texto, elementoId, callback, velocidade = 50) {
      let i = 0;
      const el = document.getElementById(elementoId);
      el.innerHTML = "";

      function escrever() {
        if (i < texto.length) {
          el.innerHTML += texto.charAt(i);
          i++;
          setTimeout(escrever, velocidade);
        } else {
          if (texto === "Agora é.") {
            document.getElementById("glitchSound").play();
            el.classList.add("glitch");
            setTimeout(() => el.classList.remove("glitch"), 1000);
          }
          if (callback) callback();
        }
      }
      escrever();
    }

    function mostrarProximaFrase() {
      if (index < frases.length) {
        typeWriter(frases[index], "mensagem", () => {
          setTimeout(mostrarProximaFrase, 2500);
        });
        index++;
      } else {
        document.getElementById("exitBtn").style.display = "inline-block";
      }
    }

    function irParaFim() {
      localStorage.setItem("playerName", playerName);
      window.location.href = "end.html";
    }

    window.onload = () => {
      playerName = prompt("Digite seu nome:") || "visitante";

      frases = [
        `Olá ${playerName}. Seu tempo foi registrado.`,
        "Você achou que era apenas um site, não é?",
        "Mas toda escolha tem um momento final.",
        "Algumas pessoas veem números... outras sentem quando vai acontecer.",
        "O relógio começou a contar assim que você entrou.",
        "Você não devia estar aqui, ainda não era a sua hora.",
        "Agora é.",
        "Não adianta fechar. Já foi marcado.",
        "O destino não aceita devoluções.",
        "Você pode tentar fugir, mas cada segundo está escrito.",
        "Quer saber um segredo? Nem todos conseguem chegar ao fim da contagem.",
        "O último som que você ouvirá não será o alarme.",
        "Você vai reconhecer o momento. Ele sempre avisa.",
        `Prepare-se, ${playerName}. O tempo não para por ninguém.`,
        "E o seu está acabando."
      ];

      mostrarProximaFrase();
    };
  </script>
</body>
</html>
