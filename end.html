<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>A Hora da Sua Morte</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Special+Elite&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body class="flash">
  <div class="app-fake">
    <h1 class="titulo">A Hora da Sua Morte</h1>
    <p class="intro">Você morrerá em:</p>

    <div id="deathTimer" class="timer">
      <div class="timer-block">
        <div class="timer-value" id="years">00</div>
        <div class="timer-label">ANO</div>
      </div>
      <div class="timer-block">
        <div class="timer-value" id="days">000</div>
        <div class="timer-label">DIAS</div>
      </div>
      <div class="timer-block">
        <div class="timer-value" id="hours">00</div>
        <div class="timer-label">HORAS</div>
      </div>
      <div class="timer-block">
        <div class="timer-value" id="minutes">00</div>
        <div class="timer-label">MINUTOS</div>
      </div>
      <div class="timer-block">
        <div class="timer-value" id="seconds">00</div>
        <div class="timer-label">SEGUNDOS</div>
      </div>
    </div>

    <p id="premonition" class="premonition"></p>

    <audio id="glitchSound" src="glitch.mp3" preload="auto"></audio>
    <button id="cancelBtn">Tentar cancelar</button>
    <p id="cancelMessage" class="cancel-message" style="display:none;"></p>
  </div>

  <script>
    window.onbeforeunload = function () {
      return "Você não pode sair agora. O tempo está correndo.";
    };

    const frases = [
      "Olá ${playerName}. Seu tempo foi registrado.",
      "Você achou que era apenas um site, não é?",
      "Mas toda escolha tem um momento final.",
      "Algumas pessoas veem números... outras sentem quando vai acontecer.",
      "O relógio começou a contar assim que você entrou.",
      "Você não devia estar aqui, ainda não era a sua hora.",
      "Agora é.",
      "Não adianta fechar. Já foi marcado.",
      "Você pode tentar fugir, mas cada segundo está contra você.",
      "Quer saber um segredo? Nem todos conseguem chegar ao fim da contagem.",
      "Vai ver-se, ${playerName}, o momento é agora.",
      "Prepare-se, ${playerName}. O tempo não para por ninguém.",
      "E o seu está acabando."
    ];

    function gerarTempoAleatorio() {
      const anos = Math.floor(Math.random() * 2);
      const dias = Math.floor(Math.random() * 365);
      const horas = Math.floor(Math.random() * 24);
      const minutos = Math.floor(Math.random() * 60);
      const segundos = Math.floor(Math.random() * 60);

      return (
        (anos * 365 * 24 * 60 * 60) +
        (dias * 24 * 60 * 60) +
        (horas * 60 * 60) +
        (minutos * 60) +
        segundos
      );
    }

    function atualizarContador(segundosTotais) {
      const years = Math.floor(segundosTotais / (365 * 24 * 60 * 60));
      segundosTotais %= (365 * 24 * 60 * 60);
      const days = Math.floor(segundosTotais / (24 * 60 * 60));
      segundosTotais %= (24 * 60 * 60);
      const hours = Math.floor(segundosTotais / (60 * 60));
      segundosTotais %= (60 * 60);
      const minutes = Math.floor(segundosTotais / 60);
      const seconds = segundosTotais % 60;

      document.getElementById("years").textContent = String(years).padStart(2, '0');
      document.getElementById("days").textContent = String(days).padStart(3, '0');
      document.getElementById("hours").textContent = String(hours).padStart(2, '0');
      document.getElementById("minutes").textContent = String(minutes).padStart(2, '0');
      document.getElementById("seconds").textContent = String(seconds).padStart(2, '0');
    }

    function iniciarContagem(segundos) {
      atualizarContador(segundos);
      const intervalo = setInterval(() => {
        segundos--;
        if (segundos <= 0) {
          clearInterval(intervalo);
          document.getElementById("premonition").textContent = "⏳ O tempo acabou.";
          document.body.classList.add("flash-intensa");
          document.getElementById("cancelBtn").style.display = "none";
          tocarGlitch();
        } else {
          atualizarContador(segundos);
        }
      }, 1000);
    }

    function gerarPremonicao() {
      const frase = frases[Math.floor(Math.random() * frases.length)];
      const premonition = document.getElementById("premonition");
      premonition.textContent = frase;

      if (frase === "Agora é.") {
        premonition.classList.add("piscar-vermelho");
      } else {
        premonition.classList.remove("piscar-vermelho");
      }
    }

    function tocarGlitch() {
      const audio = document.getElementById("glitchSound");
      if (audio.readyState >= 2) {
        audio.play().catch(() => {
          console.warn("O navegador bloqueou o som.");
        });
      } else {
        audio.addEventListener("canplaythrough", () => {
          audio.play().catch(() => {});
        }, { once: true });
      }
    }

    document.getElementById("cancelBtn").addEventListener("click", () => {
      tocarGlitch();
      tentarCancelar();
    });

    function tentarCancelar() {
      const btn = document.getElementById("cancelBtn");
      const msg = document.getElementById("cancelMessage");

      btn.style.display = "none";
      msg.textContent = "⛔ Cancelamento negado. O destino já foi selado.";
      msg.style.display = "block";
      document.body.classList.add("flash-intensa");
    }

    window.onload = () => {
      const tempoInicial = gerarTempoAleatorio();
      iniciarContagem(tempoInicial);
      gerarPremonicao();
    };
  </script>
</body>
</html>
